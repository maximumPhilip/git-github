First branch,adding some modifications